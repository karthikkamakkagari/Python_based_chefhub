{% extends "base.html" %}
{% block content %}
<div class="container">
    <div class="form-card">
        <h2 style="color:#e74c3c; text-align:center; margin-bottom:20px;">{{ title }}</h2>

        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}

            <!-- Dish fields -->
            <div class="dish-fields">
                {{ form.non_field_errors }}
                <div class="form-group">
                    {{ form.dish_id.label_tag }}<br>
                    {{ form.dish_id }}
                    {{ form.dish_id.errors }}
                </div>
                <div class="form-group">
                    {{ form.name_en.label_tag }}<br>
                    {{ form.name_en }}
                    {{ form.name_en.errors }}
                </div>
                <div class="form-group">
                    {{ form.name_te.label_tag }}<br>
                    {{ form.name_te }}
                </div>
                <div class="form-group">
                    {{ form.name_ta.label_tag }}<br>
                    {{ form.name_ta }}
                </div>
                <div class="form-group">
                    {{ form.name_hi.label_tag }}<br>
                    {{ form.name_hi }}
                </div>
                <div class="form-group">
                    {{ form.name_ka.label_tag }}<br>
                    {{ form.name_ka }}
                </div>
                <div class="form-group">
                    {{ form.preparation_en.label_tag }}<br>
                    {{ form.preparation_en }}
                </div>
                <div class="form-group">
                    {{ form.preparation_te.label_tag }}<br>
                    {{ form.preparation_te }}
                </div>
                <div class="form-group">
                    {{ form.preparation_ta.label_tag }}<br>
                    {{ form.preparation_ta }}
                </div>
                <div class="form-group">
                    {{ form.preparation_hi.label_tag }}<br>
                    {{ form.preparation_hi }}
                </div>
                <div class="form-group">
                    {{ form.preparation_ka.label_tag }}<br>
                    {{ form.preparation_ka }}
                </div>
                <div class="form-group">
                    {{ form.image.label_tag }}<br>
                    {{ form.image }}
                    {% if form.instance.image %}
                        <p>Current Image:</p>
                        <img src="{{ form.instance.image.url }}" class="dish-img-preview">
                    {% endif %}
                </div>
            </div>

            <hr>
            <h3>Ingredients</h3>

            {{ formset.management_form }}
            <table class="ingredients-table">
                <thead>
                    <tr>
                        <th>Ingredient</th>
                        <th>Quantity</th>
                        <th>Unit</th>
                        <th>Delete</th>
                    </tr>
                </thead>
                <tbody>
                    {% for f in formset %}
                    <tr>
                        <td>{{ f.ingredient }}</td>
                        <td>{{ f.quantity }}</td>
                        <td>{{ f.unit }}</td>
                        <td>
                            {% if f.instance.pk %}
                                {{ f.DELETE }}
                            {% else %}
                                <input type="checkbox" disabled>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <p>To add a new ingredient, fill the blank row at the bottom.</p>

            <div class="form-actions">
                <button type="submit" class="save-btn">ðŸ’¾ Save</button>
                <a href="{% url 'dish_list' %}" class="cancel-btn">Cancel</a>
            </div>
        </form>
    </div>
</div>

<style>
.container { max-width:800px; margin:50px auto; padding:20px; }
.form-card { background:#fff; padding:25px 20px; border-radius:15px; box-shadow:0 8px 25px rgba(0,0,0,0.2); }
.dish-img-preview { width:150px; height:150px; object-fit:cover; margin-top:10px; border-radius:12px; border:1px solid #ddd; }

.ingredients-table { width:100%; border-collapse:collapse; margin-top:15px; }
.ingredients-table th, .ingredients-table td { border:1px solid #ddd; padding:8px; text-align:center; }
.ingredients-table th { background:#f2f2f2; }

button.save-btn { background:#27ae60; color:#fff; border:none; padding:12px 25px; border-radius:8px; font-weight:bold; cursor:pointer; margin-top:15px; }
a.cancel-btn { text-decoration:none; background:#95a5a6; color:#fff; padding:12px 25px; border-radius:8px; font-weight:bold; margin-left:10px; }
</style>
{% endblock %}
